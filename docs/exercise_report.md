# 演習課題レポート：本物のアート vs AI生成アートの分類

**学籍番号**: [学籍番号を記入]  
**氏名**: [氏名を記入]

---

## 1. 問題設定

### 1.1 テーマ

本物のアート（Authentic Art）とAI生成アート（AI-Generated Art）を分類する教師あり学習モデルを構築し、SHAP（SHapley Additive exPlanations）を用いてモデルの解釈を行う。

### 1.2 目的

- WikiArtデータセットの印象派絵画（本物）とStable-Diffusionで生成された画像（フェイク）を分類する
- ランダムフォレスト分類器を用いて高精度な分類モデルを構築する
- SHAPを用いて、モデルがどの特徴量に基づいて分類を行っているかを解釈する

### 1.3 データセット概要

- **本物（Authentic）**: WikiArtの印象派絵画 8,664件
- **フェイク（Fake）**: Stable-Diffusionで生成された画像 8,664件
- **合計**: 17,328件（ペア数: 8,664ペア）
- **クラス分布**: 完全にバランス（50%:50%）

---

## 2. データの作成方法

### 2.1 説明変数（特徴量）

合計44カラムの数値特徴量を使用しました。特徴量は以下の4つのカテゴリに分類されます：

#### 2.1.1 色彩特徴量（19カラム）

HSV色空間での分析を行いました：

- **HSV基本統計量**（6カラム）:
  - `mean_hue`: 色相の平均値（0-179度）
  - `mean_saturation`: 彩度の平均値（0-255）
  - `mean_value`: 明度の平均値（0-255）
  - `hue_std`, `saturation_std`, `value_std`: 各チャネルの標準偏差

- **支配色分析**（9カラム）:
  - K-meansクラスタリング（k=5）で支配色を抽出
  - 支配色のHSV統計量（平均値、標準偏差）
  - 支配色の占有率（最大値、平均値、標準偏差）

- **明度分布**（3カラム）:
  - `brightness_skewness`: 明度分布の歪度
  - `brightness_kurtosis`: 明度分布の尖度
  - `brightness_entropy`: 明度分布のエントロピー

- **色の多様性**（1カラム）:
  - `color_diversity`: 色相の分散

#### 2.1.2 テクスチャ特徴量（10カラム）

画像のテクスチャ（質感）を分析しました：

- **GLCM特徴量**（5カラム）:
  - `texture_glcm_contrast`: コントラスト（局所的な明度の変化）
  - `texture_glcm_dissimilarity`: 非類似度（画素間の明度の差）
  - `texture_glcm_homogeneity`: 均質性（画素間の類似度）
  - `texture_glcm_energy`: エネルギー（規則性）
  - `texture_glcm_correlation`: 相関（画素間の線形関係）

- **LBP特徴量**（5カラム）:
  - `texture_lbp_mean`: LBP値の平均
  - `texture_lbp_std`: LBP値の標準偏差
  - `texture_lbp_histogram_entropy`: LBPヒストグラムのエントロピー
  - `texture_lbp_histogram_skewness`: LBPヒストグラムの歪度
  - `texture_lbp_histogram_kurtosis`: LBPヒストグラムの尖度

#### 2.1.3 エッジ特徴量（9カラム）

Cannyエッジ検出を使用してエッジを分析しました：

- **エッジ密度・カウント**（2カラム）:
  - `edge_density`: エッジ画素の割合
  - `edge_count`: エッジコンポーネントの数

- **エッジ長さ**（2カラム）:
  - `edge_mean_length`: エッジコンポーネントの平均長さ
  - `edge_std_length`: エッジ長さの標準偏差

- **エッジ方向性**（2カラム）:
  - `edge_orientation_mean`: エッジ方向の平均
  - `edge_orientation_std`: エッジ方向の標準偏差

- **エッジ滑らかさ・曲率**（3カラム）:
  - `edge_smoothness`: エッジの滑らかさ
  - `edge_curvature_mean`: エッジ曲率の平均
  - `edge_curvature_std`: エッジ曲率の標準偏差

#### 2.1.4 ゲシュタルト原則スコア（6カラム）

LLM（LLaVA 7B）が評価したゲシュタルト原則のスコア：

- `simplicity_score`: 簡潔性（1-5点）
- `proximity_score`: 近接性（1-5点）
- `similarity_score`: 類同性（1-5点）
- `continuity_score`: 連続性（1-5点）
- `closure_score`: 閉合性（1-5点）
- `figure_ground_score`: 図地分離（1-5点）

### 2.2 教師データ（ラベル）

- **0**: 本物（Authentic）- WikiArtの印象派絵画
- **1**: フェイク（Fake）- Stable-Diffusionで生成された画像

### 2.3 データ前処理

- **標準化**: 訓練データのみでStandardScalerをfitし、テストデータには適用しない（データリーク防止）
- **データ分割**: 訓練データ80%、テストデータ20%（stratifyを使用してクラス分布を保持）

### 2.4 サンプルデータ

データセットの概要：
- 総サンプル数: 17,328件
- 特徴量数: 44カラム（数値特徴量）
- クラス数: 2（本物/フェイク）
- クラス分布: 完全にバランス（各8,664件）

特徴量の例：
- `mean_hue`: 52.61（平均値）、21.76（標準偏差）
- `saturation_std`: 51.34（平均値）、15.22（標準偏差）
- `texture_lbp_std`: 約2.5（平均値）、約0.12（SHAP重要度）

---

## 3. 精度

### 3.1 モデル性能

- **訓練精度**: 99.96%
- **テスト精度**: 95.18%
- **交差検証スコア**: 94.98% (+/- 1.11%)

### 3.2 混同行列

| 実際 \ 予測 | Authentic (0) | Fake (1) | 合計 |
|------------|---------------|----------|------|
| Authentic (0) | 1,635 | 98 | 1,733 |
| Fake (1) | 69 | 1,664 | 1,733 |
| **合計** | **1,704** | **1,762** | **3,466** |

### 3.3 分類レポート

```
               precision    recall  f1-score   support

Authentic (0)       0.96      0.94      0.95      1733
     Fake (1)       0.94      0.96      0.95      1733

     accuracy                           0.95      3466
    macro avg       0.95      0.95      0.95      3466
 weighted avg       0.95      0.95      0.95      3466
```

### 3.4 誤分類分析

- **誤分類数**: 167件（4.82%）
- **偽陽性（False Positive）**: 98件（本物をフェイクと誤分類）
- **偽陰性（False Negative）**: 69件（フェイクを本物と誤分類）

### 3.5 混同行列の解釈

混同行列（`data/visualizations/latest/confusion_matrix.png`）から以下のことがわかります：

1. **高い精度**: テスト精度95.18%は、本物とフェイクを高い精度で分類できていることを示しています。

2. **バランスの取れた性能**: 
   - Authenticクラス: Precision 0.96, Recall 0.94
   - Fakeクラス: Precision 0.94, Recall 0.96
   - 両クラスでバランスの取れた性能を示しています。

3. **誤分類の傾向**:
   - 偽陽性（本物→フェイク）が98件と、偽陰性（フェイク→本物）の69件より多い
   - これは、一部の本物の絵画がAI生成画像に似た特徴を持つことを示唆しています。

---

## 4. SHAP解釈結果

### 4.1 SHAP概要

SHAP（SHapley Additive exPlanations）は、各特徴量が予測にどの程度寄与しているかを定量的に評価する手法です。本レポートでは、SHAP summary plotと特徴量重要度を用いてモデルの解釈を行いました。

### 4.2 特徴量重要度（上位10特徴量）

SHAP特徴量重要度（平均絶対SHAP値）の上位10特徴量：

| 順位 | 特徴量名 | SHAP重要度 | カテゴリ |
|------|----------|------------|----------|
| 1 | `texture_lbp_std` | 0.116 | テクスチャ（LBP） |
| 2 | `saturation_std` | 0.063 | 色彩（HSV） |
| 3 | `texture_lbp_histogram_entropy` | 0.051 | テクスチャ（LBP） |
| 4 | `mean_hue` | 0.035 | 色彩（HSV） |
| 5 | `texture_glcm_homogeneity` | 0.034 | テクスチャ（GLCM） |
| 6 | `dominant_color_hue_mean` | 0.020 | 色彩（支配色） |
| 7 | `value_std` | 0.018 | 色彩（HSV） |
| 8 | `dominant_color_hue_std` | 0.018 | 色彩（支配色） |
| 9 | `dominant_color_saturation_std` | 0.016 | 色彩（支配色） |
| 10 | `hue_std` | 0.016 | 色彩（HSV） |

### 4.3 SHAP Summary Plotの解釈

SHAP summary plot（`data/visualizations/latest/shap_summary_plot.png`）から以下のことがわかります：

1. **テクスチャ特徴量の重要性**:
   - `texture_lbp_std`（LBP値の標準偏差）が最も高い重要度を示しています
   - これは、本物とフェイクの画像でテクスチャのばらつきが異なることを示唆しています
   - 本物の絵画は、筆触や技法により多様なテクスチャパターンを持つ傾向があります
   - AI生成画像は、生成プロセスの特性により、テクスチャパターンが限定的になる可能性があります

2. **色彩特徴量の重要性**:
   - `saturation_std`（彩度の標準偏差）が2番目に高い重要度を示しています
   - `mean_hue`（色相の平均値）も上位にランクインしています
   - これは、本物とフェイクの画像で色彩の分布が異なることを示唆しています
   - 本物の絵画は、芸術的訓練により色の多様性が制御されている可能性があります
   - AI生成画像は、プロンプトに基づいて生成されるため、不自然な色の分布になりやすい可能性があります

3. **SHAP値の分布**:
   - 各特徴量のSHAP値は、正の値（フェイクと予測する方向）と負の値（本物と予測する方向）の両方を持っています
   - これは、同じ特徴量でも値によって予測が異なることを示しています
   - 例えば、`texture_lbp_std`が高い値を持つ場合、フェイクと予測する方向に寄与し、低い値を持つ場合、本物と予測する方向に寄与します

### 4.4 特徴量重要度プロットの解釈

特徴量重要度プロット（`data/visualizations/latest/shap_feature_importance.png`）から以下のことがわかります：

1. **テクスチャ特徴量の優位性**:
   - 上位3特徴量のうち2つがテクスチャ特徴量（LBP）です
   - これは、テクスチャが本物とフェイクの区別において最も重要な要素であることを示しています

2. **色彩特徴量の重要性**:
   - 上位10特徴量のうち6つが色彩特徴量です
   - これは、色彩も本物とフェイクの区別において重要な要素であることを示しています

3. **ゲシュタルト原則スコアの低い重要度**:
   - ゲシュタルト原則スコアは、全体的に低い重要度を示しています
   - これは、ゲシュタルト原則スコアが本物とフェイクの区別において直接的な影響が小さいことを示唆しています

### 4.5 Dependence Plotの解釈

依存関係プロット（`data/visualizations/latest/dependence_plot_*.png`）から以下のことがわかります：

1. **特徴量間の相互作用**:
   - 各特徴量のSHAP値は、他の特徴量の値に依存して変化します
   - これは、特徴量間の相互作用が予測に影響を与えていることを示しています

2. **非線形な関係**:
   - 多くの特徴量で、SHAP値と特徴量値の間に非線形な関係が見られます
   - これは、ランダムフォレストが非線形な関係を捉えていることを示しています

### 4.6 総合的な解釈

SHAP解釈結果から、以下のことが明らかになりました：

1. **テクスチャが最も重要**:
   - テクスチャ特徴量（特にLBP）が本物とフェイクの区別において最も重要な役割を果たしています
   - 本物の絵画は、筆触や技法により多様なテクスチャパターンを持つ傾向があります
   - AI生成画像は、生成プロセスの特性により、テクスチャパターンが限定的になる可能性があります

2. **色彩も重要**:
   - 色彩特徴量（特に彩度の標準偏差と色相の平均値）も本物とフェイクの区別において重要な役割を果たしています
   - 本物の絵画は、芸術的訓練により色の多様性が制御されている可能性があります
   - AI生成画像は、プロンプトに基づいて生成されるため、不自然な色の分布になりやすい可能性があります

3. **ゲシュタルト原則の限界**:
   - ゲシュタルト原則スコアは、全体的に低い重要度を示しています
   - これは、ゲシュタルト原則スコアが本物とフェイクの区別において直接的な影響が小さいことを示唆しています
   - ただし、ゲシュタルト原則スコアは、人間の視覚的知覚を数値化したものであり、将来的な研究で有用な可能性があります

4. **モデルの信頼性**:
   - テスト精度95.18%は、モデルが本物とフェイクを高い精度で分類できていることを示しています
   - SHAP解釈により、モデルがどの特徴量に基づいて分類を行っているかが明らかになりました
   - これは、モデルの判断根拠を理解し、信頼性を評価する上で重要です

---

## 5. まとめ

本演習では、本物のアートとAI生成アートを分類する教師あり学習モデルを構築し、SHAPを用いてモデルの解釈を行いました。

### 5.1 主な成果

1. **高精度な分類モデル**: テスト精度95.18%を達成
2. **解釈可能なモデル**: SHAPを用いて、モデルの判断根拠を明らかに
3. **特徴量の重要性**: テクスチャ特徴量が最も重要であることを発見

### 5.2 今後の課題

1. **誤分類の改善**: 誤分類167件（4.82%）をさらに減らす方法の検討
2. **特徴量の拡張**: より多くの特徴量を追加して精度向上を目指す
3. **他の生成モデル**: FLUX、F-Liteなどの他の生成モデルでの検証

---

## 参考文献

- SHAP: SHapley Additive exPlanations (Lundberg & Lee, 2017)
- WikiArt_VLM Dataset
- Gestalt Principles in visual perception
- scikit-learn: Random Forest Classifier

---

*本レポートは、説明可能AIによる絵画様式分類プロジェクトの成果をまとめたものです。*

